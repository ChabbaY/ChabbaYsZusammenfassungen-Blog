<!doctype html>
<html lang="en-US" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.19" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.68" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme="dark"] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background: var(--vp-c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://chabbay.github.io/ChabbaYsZusammenfassungen-Blog/posts/WiSe2425/SicherheitVonWebanwendungen.html"><meta property="og:site_name" content="Zusammenfassungen"><meta property="og:title" content="Sicherheit von Webanwendungen"><meta property="og:description" content="Sicherheit von Webanwendungen Grundlagen Authentifizierung Nachweis der Identität durch den Server Verschlüsselung Von Klartext zu Ciphertext durch Cipher / Chiffre, symmetrisch..."><meta property="og:type" content="website"><meta property="og:locale" content="en-US"><meta property="og:updated_time" content="2025-01-28T16:14:17.000Z"><meta property="article:author" content="Linus Englert"><meta property="article:published_time" content="2025-01-28T00:00:00.000Z"><meta property="article:modified_time" content="2025-01-28T16:14:17.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"WebPage","name":"Sicherheit von Webanwendungen","description":"Sicherheit von Webanwendungen Grundlagen Authentifizierung Nachweis der Identität durch den Server Verschlüsselung Von Klartext zu Ciphertext durch Cipher / Chiffre, symmetrisch..."}</script><title>Sicherheit von Webanwendungen | Zusammenfassungen</title><meta name="description" content="Sicherheit von Webanwendungen Grundlagen Authentifizierung Nachweis der Identität durch den Server Verschlüsselung Von Klartext zu Ciphertext durch Cipher / Chiffre, symmetrisch...">
    <link rel="preload" href="/ChabbaYsZusammenfassungen-Blog/assets/style-DuKa6cAs.css" as="style"><link rel="stylesheet" href="/ChabbaYsZusammenfassungen-Blog/assets/style-DuKa6cAs.css">
    <link rel="modulepreload" href="/ChabbaYsZusammenfassungen-Blog/assets/app-CEbH5TK9.js"><link rel="modulepreload" href="/ChabbaYsZusammenfassungen-Blog/assets/SicherheitVonWebanwendungen.html-BUrMgaK6.js"><link rel="modulepreload" href="/ChabbaYsZusammenfassungen-Blog/assets/plugin-vue_export-helper-DlAUqK2U.js">
    <link rel="prefetch" href="/ChabbaYsZusammenfassungen-Blog/assets/index.html-DeABILv3.js" as="script"><link rel="prefetch" href="/ChabbaYsZusammenfassungen-Blog/assets/Datenmanagement.html-BHS5wDt-.js" as="script"><link rel="prefetch" href="/ChabbaYsZusammenfassungen-Blog/assets/index.html-EIGM89pp.js" as="script"><link rel="prefetch" href="/ChabbaYsZusammenfassungen-Blog/assets/Rechnerarchitektur.html-Rux-B5iG.js" as="script"><link rel="prefetch" href="/ChabbaYsZusammenfassungen-Blog/assets/Softwarearchitektur.html-6MslAV74.js" as="script"><link rel="prefetch" href="/ChabbaYsZusammenfassungen-Blog/assets/ComputergrafikUndBildverarbeitung.html-CTtrlI0g.js" as="script"><link rel="prefetch" href="/ChabbaYsZusammenfassungen-Blog/assets/index.html-BLV2csrJ.js" as="script"><link rel="prefetch" href="/ChabbaYsZusammenfassungen-Blog/assets/Datenbanksysteme.html-BZkxfHnx.js" as="script"><link rel="prefetch" href="/ChabbaYsZusammenfassungen-Blog/assets/Informationssysteme.html-Bk38Td9u.js" as="script"><link rel="prefetch" href="/ChabbaYsZusammenfassungen-Blog/assets/index.html-B3RpqwQ6.js" as="script"><link rel="prefetch" href="/ChabbaYsZusammenfassungen-Blog/assets/404.html-BygnQI_n.js" as="script"><link rel="prefetch" href="/ChabbaYsZusammenfassungen-Blog/assets/index.html-CWSODX9k.js" as="script"><link rel="prefetch" href="/ChabbaYsZusammenfassungen-Blog/assets/index.html-DabmNTOK.js" as="script"><link rel="prefetch" href="/ChabbaYsZusammenfassungen-Blog/assets/index.html-f6ucZl0X.js" as="script"><link rel="prefetch" href="/ChabbaYsZusammenfassungen-Blog/assets/index.html-CunOn1El.js" as="script"><link rel="prefetch" href="/ChabbaYsZusammenfassungen-Blog/assets/index.html-Cr_1mKQW.js" as="script"><link rel="prefetch" href="/ChabbaYsZusammenfassungen-Blog/assets/index.html-B_3VzlgK.js" as="script"><link rel="prefetch" href="/ChabbaYsZusammenfassungen-Blog/assets/photoswipe.esm-CMg0yb1C.js" as="script"><link rel="prefetch" href="/ChabbaYsZusammenfassungen-Blog/assets/setupDevtools-7MC2TMWH-ZE_x4kIC.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">Skip to main content</a><!--]--><div class="theme-container external-link-icon has-toc" vp-container><!--[--><header id="navbar" class="vp-navbar" vp-navbar><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><a class="route-link vp-brand" href="/ChabbaYsZusammenfassungen-Blog/" aria-label="Take me home"><img class="vp-nav-logo" src="https://bilder.chabbay.de/icon.png" alt><!----><span class="vp-site-name hide-in-pad">Zusammenfassungen</span></a><!--]--></div><div class="vp-navbar-center"><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/ChabbaYsZusammenfassungen-Blog/" aria-label="Home"><!--[--><i class="vp-icon fas fa-home" style=""></i><!--]-->Home<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link route-link-active auto-link" href="/ChabbaYsZusammenfassungen-Blog/posts/" aria-label="Zusammenfassungen"><!--[--><i class="vp-icon fas fa-book" style=""></i><!--]-->Zusammenfassungen<!----></a></div></nav><!--]--></div><div class="vp-navbar-end"><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/ChabbaY/ChabbaYsZusammenfassungen-Blog" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-color-mode-switch" id="color-mode-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" name="auto" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" name="dark" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" name="light" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!----><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar" vp-sidebar><!----><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/ChabbaYsZusammenfassungen-Blog/" aria-label="Home"><!--[--><i class="vp-icon fas fa-home" style=""></i><!--]-->Home<!----></a></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-header active"><i class="vp-icon fas fa-book" style=""></i><span class="vp-sidebar-title">Zusammenfassungen</span><!----></p><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Sommersemester 2024</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Wintersemester 2022 / 2023</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><!----><span class="vp-sidebar-title">Wintersemester 2024 / 2025</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/ChabbaYsZusammenfassungen-Blog/posts/WiSe2425/" aria-label="Wintersemester 2024 / 2025"><!---->Wintersemester 2024 / 2025<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/ChabbaYsZusammenfassungen-Blog/posts/WiSe2425/ComputergrafikUndBildverarbeitung.html" aria-label="Computergarfik und Bildverarbeitung"><!---->Computergarfik und Bildverarbeitung<!----></a></li><li><a class="route-link route-link-active auto-link vp-sidebar-link active" href="/ChabbaYsZusammenfassungen-Blog/posts/WiSe2425/SicherheitVonWebanwendungen.html" aria-label="Sicherheit von Webanwendungen"><!---->Sicherheit von Webanwendungen<!----></a></li></ul></section></li></ul></section></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->Sicherheit von Webanwendungen</h1><div class="page-info"><span class="page-author-info" aria-label="Author🖊" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><span class="page-author-item">Linus Englert</span></span><span property="author" content="Linus Englert"></span></span><!----><span class="page-date-info" aria-label="Writing Date📅" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span data-allow-mismatch="text">January 28, 2025</span><meta property="datePublished" content="2025-01-28T00:00:00.000Z"></span><!----><span class="page-reading-time-info" aria-label="Reading Time⌛" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>About 16 min</span><meta property="timeRequired" content="PT16M"></span><!----><!----></div><hr></div><div class="vp-toc-placeholder"><aside id="toc" vp-toc><!----><!--[--><div class="vp-toc-header">On This Page<button type="button" class="print-button" title="Print"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon" name="print"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#grundlagen">Grundlagen</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#http-hypertext-transfer-protocol">HTTP (Hypertext Transfer Protocol)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#html-hypertext-markup-language">HTML (Hypertext Markup Language)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#web-browser">Web-Browser</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#web-anwendung">Web-Anwendung</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_01-broken-access-control">01 Broken Access Control</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#direct-object-references">Direct Object References</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#access-control">Access Control</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#angriffsmoglichkeiten-von-access-control">Angriffsmöglichkeiten von Access Control</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#schutzmechanismen-bei-access-control">Schutzmechanismen bei Access Control</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_08-2013-cross-site-request-forgery">08/2013 Cross Site Request Forgery</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_02-cryptographic-failures">02 Cryptographic Failures</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#gegenmaßnahmen-gegen-cryptographic-failures">Gegenmaßnahmen gegen Cryptographic Failures</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#sichere-kryptographische-speicherung">Sichere kryptographische Speicherung</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#verwendung-von-ssl-tls-by-design">Verwendung von SSL / TLS (by Design)</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_03-injection-angriffe">03 Injection-Angriffe</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#sql-injection">SQL Injection</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_07-2017-cross-site-scripting">07/2017 Cross Site Scripting</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_04-insecure-design">04 Insecure Design</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#secure-design">Secure Design</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#bedrohungsanalyse">Bedrohungsanalyse</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#security-patterns">Security Patterns</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#sicherheit-in-internet-anwendungen">Sicherheit in Internet Anwendungen</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_05-security-misconfiguration">05 Security Misconfiguration</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#sichere-konfiguration">Sichere Konfiguration</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#xml-external-entities-xxe">XML eXternal Entities (XXE)</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_06-vulnerable-and-outdated-components">06 Vulnerable and Outdated Components</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#common-vulnerabilty-and-exposures-cve">Common Vulnerabilty and Exposures (CVE)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#schutzmaßnahmen-gegen-vulnerable-and-outdated-components">Schutzmaßnahmen gegen Vulnerable and Outdated Components</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#gateways">Gateways</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_07-identification-and-authorization-failures">07 Identification and Authorization Failures</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#mogliche-schwachstellen-zu-authentifikation-und-session-management">Mögliche Schwachstellen zu Authentifikation und Session Management</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#moglicher-angriff-session-fixation">Möglicher Angriff: Session Fixation</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#allgemeine-richtlinien-zur-authentifizierung">Allgemeine Richtlinien zur Authentifizierung</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#allgemeine-richtlinien-zum-session-management">Allgemeine Richtlinien zum Session Management</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_08-software-and-data-integrity-failures">08 Software and Data Integrity Failures</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#gegenmaßnahmen-zu-software-and-data-integrity-failures">Gegenmaßnahmen zu Software and Data Integrity Failures</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_09-security-logging-and-monitoring-failures">09 Security Logging and Monitoring Failures</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#vorteile-durch-logging">Vorteile durch Logging</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#sicheres-logging">Sicheres Logging</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_10-2013-unvalidated-redirects-and-forwards">10/2013 Unvalidated Redirects and Forwards</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#gegenmaßnahmen-zu-unvalidated-redirects-and-forwards">Gegenmaßnahmen zu Unvalidated Redirects and Forwards</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#prinzipien-sicherer-webanwendungen">Prinzipien sicherer Webanwendungen</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-kenne-das-sicherheitsmodell-des-verwendeten-frameworks">1. Kenne das Sicherheitsmodell des verwendeten Frameworks</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-vertraue-nicht-dem-client">2. Vertraue nicht dem Client</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-vermeide-die-nutzung-gefahrlicher-methoden">3. Vermeide die Nutzung gefährlicher Methoden</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_4-verwende-sichere-kommunikation">4. Verwende sichere Kommunikation</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_5-harte-den-web-server">5. Härte den Web-Server</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_6-beschranke-die-komplexitat-auf-das-notwendige">6. Beschränke die Komplexität auf das Notwendige</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_7-verwende-security-patterns-wo-moglich">7. Verwende Security Patterns wo möglich</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_8-defense-in-depth">8. Defense in Depth</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_9-check-at-the-gate">9. Check at the Gate</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_10-fail-securely">10. Fail securely</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_11-secure-defaults">11. Secure Defaults</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#testen-von-webanwendungen">Testen von Webanwendungen</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#penetration-testing">Penetration Testing</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#owasp-testing-framework">OWASP Testing Framework</a></li><!----><!--]--></ul></li><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!--]--><!----></aside></div><!----><div class="theme-hope-content" vp-content><h1 id="sicherheit-von-webanwendungen" tabindex="-1"><a class="header-anchor" href="#sicherheit-von-webanwendungen"><span>Sicherheit von Webanwendungen</span></a></h1><h2 id="grundlagen" tabindex="-1"><a class="header-anchor" href="#grundlagen"><span>Grundlagen</span></a></h2><ul><li>Authentifizierung <ul><li>Nachweis der Identität durch den Server</li></ul></li><li>Verschlüsselung <ul><li>Von Klartext zu Ciphertext durch Cipher / Chiffre, symmetrisch oder asymmetrisch, umkehrbar</li></ul></li><li>kryptografische Prüfsumme <ul><li>Synonym für Hash</li></ul></li><li>Sicherheitsziele <ul><li>CIA: Confidentiality, Integrity, Availability; Privatheit; Authentizität; Verbindlichkeit / Nichtabstreitbarkeit</li></ul></li><li>Härtung <ul><li>Verbesserung der Resilienz eines Systems</li></ul></li><li>Passwörter <ul><li>gehasht gespeichert, gesalzen, Übertragung im Klartext</li></ul></li><li>Zertifikate <ul><li>asymmetrische Kryptografie, Nachweis der Echtheit, Baumstruktur mit Root CA</li></ul></li><li>Angriffswerkzeuge bei Webanwendungen <ul><li>ZAP, burp, hydra, john the ripper, cupps</li></ul></li><li>OWASP TOP 10 <ul><li>neues Ranking erste Hälfte von 2025</li><li>Ergebnis von 2021: <ol><li>Broken Access Control</li><li>Cryptographic Failures</li><li>Injection</li><li>Insecure Design</li><li>Security Misconfiguration</li><li>Vulnerable and Outdated Components</li><li>Identification and Authentication Failures</li><li>Software and Data Integrity Failures</li><li>Security Logging and Monitoring Failures</li><li>Server Side Request Forgery</li></ol></li></ul></li></ul><h3 id="http-hypertext-transfer-protocol" tabindex="-1"><a class="header-anchor" href="#http-hypertext-transfer-protocol"><span>HTTP (Hypertext Transfer Protocol)</span></a></h3><p>Bestandteile eines HTTP Requests</p><ul><li><strong>Methode</strong> (GET, POST, PUT, DELETE, HEAD, PATCH)</li><li><strong>URL</strong> (Uniform Resource Locator) <ul><li>Protokoll (http / https)</li><li>Host</li><li>Port (sonst 80 / 443)</li><li>Verzeichnis</li><li>Ressource</li><li>Parameter (? ... &amp; ...)</li><li>Anker (#)</li></ul></li><li>Protokoll <strong>Version</strong> (z.B. HTTP/1.1)</li><li><strong>Headers</strong> (Host, User-Agent, Accept, ...)</li><li><strong>Body</strong> (optional) nach einer Leerzeile</li></ul><p>Bestandteile der HTTP Response</p><ul><li>Version</li><li>Status</li><li>Status-Nachricht</li><li>Headers</li><li>Body nach einer Leerzeile</li></ul><h3 id="html-hypertext-markup-language" tabindex="-1"><a class="header-anchor" href="#html-hypertext-markup-language"><span>HTML (Hypertext Markup Language)</span></a></h3><p>markiert und attributiert Bestandteile eines Dokuments, Darstellung durch Browser</p><p>Baumstruktur durch Schachtelung der Tags <mjx-container class="MathJax" jax="SVG" style="position:relative;"><svg style="vertical-align:-0.025ex;" xmlns="http://www.w3.org/2000/svg" width="2.262ex" height="1.181ex" role="img" focusable="false" viewBox="0 -511 1000 522" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">→</mo></math></mjx-assistive-mml></mjx-container> <strong>DOM</strong> (Document Object Model)</p><ul><li><strong>Programmierschnittstelle</strong> für Manipulation der Seite <ul><li>Animationen</li><li>Rich Internet Applications</li><li>browserunabhängig, in Skriptsprachen integriert</li></ul></li></ul><h3 id="web-browser" tabindex="-1"><a class="header-anchor" href="#web-browser"><span>Web-Browser</span></a></h3><p>Client-Programm für die Darstellung von Webseiten / Webanwendungen</p><p>Basiert in der Regel auf Chromium oder Firefox</p><figure><img src="/ChabbaYsZusammenfassungen-Blog/assets/aufbau-browser-CFa4PPUW.png" alt="Aufbau Browser" tabindex="0" loading="lazy"><figcaption>Aufbau Browser</figcaption></figure><ul><li><strong>User Interface</strong>: Menüleiste und Navigation</li><li><strong>Browser Engine</strong>: Koordination zwischen UI und Rendering Engine</li><li><strong>Rendering Engine</strong>: Parsing von HTML und CSS <mjx-container class="MathJax" jax="SVG" style="position:relative;"><svg style="vertical-align:-0.025ex;" xmlns="http://www.w3.org/2000/svg" width="2.262ex" height="1.181ex" role="img" focusable="false" viewBox="0 -511 1000 522" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">→</mo></math></mjx-assistive-mml></mjx-container> Darstellung</li><li><strong>Data Storage</strong>: Persistierung (z.B. Cookies)</li><li><strong>UI Backend</strong>: benutzt Methoden des OS</li><li><strong>JavaScript Interpreter</strong>: kann JavaScript ausführen</li><li><strong>Networking</strong>: Kommunikation über das Internet</li></ul><h3 id="web-anwendung" tabindex="-1"><a class="header-anchor" href="#web-anwendung"><span>Web-Anwendung</span></a></h3><p>Software, die auf einem Webserver ausgeführt wird und auf Benutzereingaben (HTTP) dynamisch reagiert</p><p>Angreifbar sind sowohl Client-Anwendung als auch Kommunikation und Server-Anwendung</p><h2 id="_01-broken-access-control" tabindex="-1"><a class="header-anchor" href="#_01-broken-access-control"><span>01 Broken Access Control</span></a></h2><p>Fehlerhafte <strong>Autorisierung</strong> (Konfiguration oder Code der Authentifizierung)</p><p>Beinhaltet ehemalige Kategorien <strong>Insecure Direct Object References</strong> und <strong>Missing Function Level Access Control</strong></p><h3 id="direct-object-references" tabindex="-1"><a class="header-anchor" href="#direct-object-references"><span>Direct Object References</span></a></h3><ul><li>Referenz durch Pfad nach außen sichtbar</li><li>Referenz kann manipuliert werden</li><li>Dadurch möglicherweise Zugriff auf Objekt, für das der Anwender keine Rechte hat</li><li>Jeder Zugriff auf direkte Objektreferenzen MUSS eine Überprüfung der Autorisierung beinhalten</li></ul><h3 id="access-control" tabindex="-1"><a class="header-anchor" href="#access-control"><span>Access Control</span></a></h3><ul><li><strong>Role-based Access Control</strong> (RBAC) <ul><li>zugewiesene Rollen <mjx-container class="MathJax" jax="SVG" style="position:relative;"><svg style="vertical-align:-0.025ex;" xmlns="http://www.w3.org/2000/svg" width="2.262ex" height="1.181ex" role="img" focusable="false" viewBox="0 -511 1000 522" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">→</mo></math></mjx-assistive-mml></mjx-container> daraus Berechtigungen</li></ul></li><li><strong>Attribute-based Access Control</strong> (ABAC) <ul><li>zugewiesene Policies <mjx-container class="MathJax" jax="SVG" style="position:relative;"><svg style="vertical-align:-0.025ex;" xmlns="http://www.w3.org/2000/svg" width="2.262ex" height="1.181ex" role="img" focusable="false" viewBox="0 -511 1000 522" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">→</mo></math></mjx-assistive-mml></mjx-container> beinhalten Attribute <mjx-container class="MathJax" jax="SVG" style="position:relative;"><svg style="vertical-align:-0.025ex;" xmlns="http://www.w3.org/2000/svg" width="2.262ex" height="1.181ex" role="img" focusable="false" viewBox="0 -511 1000 522" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">→</mo></math></mjx-assistive-mml></mjx-container> Evaluation über Bool&#39;sche Berechnung</li><li>auch &quot;policy-based&quot; (PBAC) oder &quot;claims-based&quot; (CBAC)</li></ul></li></ul><h3 id="angriffsmoglichkeiten-von-access-control" tabindex="-1"><a class="header-anchor" href="#angriffsmoglichkeiten-von-access-control"><span>Angriffsmöglichkeiten von Access Control</span></a></h3><ul><li>Directory Traversal <ul><li><strong>Local File</strong>: durch bspw. &quot;../&quot; o.ä. wird eine lokale Datei wie /etc/passwd eingebunden</li><li><strong>Remote File</strong>: eine potenziell schädliche Datei wird als Parameter übergeben</li><li><strong>Environment Discovery</strong>: Rückschluss auf Netzwerkstruktur</li><li><strong>Show Source Code</strong>: Rückschluss auf Quelltext</li></ul></li><li>URL Encoding und Double URL Encoding <ul><li>&quot;../&quot; als &quot;%2e%2e%2f&quot;</li></ul></li><li>Unicode /UTF-8 Encoding <ul><li>&quot;../&quot; als &quot;..%c0%af&quot;</li></ul></li><li>Forced Browsing (bruteforce) <ul><li>Testen von &quot;Standard&quot;-Verzeichnissen</li></ul></li></ul><h3 id="schutzmechanismen-bei-access-control" tabindex="-1"><a class="header-anchor" href="#schutzmechanismen-bei-access-control"><span>Schutzmechanismen bei Access Control</span></a></h3><ul><li><strong>DRY</strong> (don&#39;t repeat yourself): einmalige Implementierung + Vererbung</li><li>konfigurierbare Rollen</li><li>nur anzeigen, worauf zugegriffen werden kann</li><li>OWASP &quot;Guide to Authorization&quot;: <ol><li>regelmäßig Rechte <strong>neu testen</strong> oder Benutzer abmelden</li><li><strong>Least Privilege</strong>: so wenige Rechte wie möglich, so viele Rechte wie nötig</li><li><strong>Zentralisierte Autorisierung</strong>: <ins>eine</ins> Schnittstelle</li><li>Zugangskontrolle bei geschützten Ressourcen: nicht nur prüfen ob Aktion erlaubt, sondern auch ob Zugriff erlaubt</li><li>Auch Zugriff auf statische Ressourcen schützen: z.B. zufälliger Datei- oder Ordnername</li><li>Reautorisierung oder sogar Reauthentifizierung bei wichtigen Aktionen</li><li>Geeignetes <strong>Framework</strong> nutzen, kein eigener Code</li><li><strong>Session Management</strong> beachten, Autorisierung an Session koppeln</li></ol></li></ul><h3 id="_08-2013-cross-site-request-forgery" tabindex="-1"><a class="header-anchor" href="#_08-2013-cross-site-request-forgery"><span>08/2013 Cross Site Request Forgery</span></a></h3><p>Angreifer erzeugt gefälschten HTTP Request, der von Opfer übermittelt wird (Image Tags, XSS, ...)</p><p>Wenn der Nutzer angemeldet ist, können Aktionen in dessen Namen ausgeführt werden:</p><ul><li>Logout</li><li>Nachricht senden</li><li>Nutzer anlegen / löschen</li><li>Passwortänderung</li><li>Transfer von Geld / Daten</li></ul><h4 id="mogliche-verwundbarkeitstests" tabindex="-1"><a class="header-anchor" href="#mogliche-verwundbarkeitstests"><span>Mögliche Verwundbarkeitstests</span></a></h4><ul><li><strong>Black Box Test</strong>: Nachstellung eines Angriffs mit zwei Accounts</li><li><strong>Gray Box Test</strong>: Werden nur Browserdaten (z.B. Cookies) für Authentifizierung / Autorisierung benötigt?</li></ul><h4 id="gegenmaßnahmen-gegen-csrf" tabindex="-1"><a class="header-anchor" href="#gegenmaßnahmen-gegen-csrf"><span>Gegenmaßnahmen gegen CSRF</span></a></h4><ul><li><strong>Synchronizer Token</strong> (auch CSRF Token) <ul><li>zufälliges Token für Benutzer-Session</li><li>wird Formularen als &quot;hidden&quot; Parameter hinzugefügt</li><li>HTTP Request muss Token beinhalten</li><li>Server muss Token prüfen</li><li><strong>Problem</strong>: kann wegen GET-Request in Browser Historie auftauchen</li></ul></li><li><strong>Double Submit Cookie</strong><ul><li>kryptografisch stark zufällig</li><li>Cookie und &quot;hidden&quot; Parameter</li><li>Server kann Wert berechnen</li><li>Angreifer kann Cookie nicht auslesen</li></ul></li><li><strong>Encrypted Token Pattern</strong><ul><li>Verschlüsselung von Informationen und Zufallswert (<strong>NONCE</strong>)</li><li>Nutzer muss dies zurück übermitteln</li><li>Server kann entschlüsseln und prüfen <mjx-container class="MathJax" jax="SVG" style="position:relative;"><svg style="vertical-align:-0.025ex;" xmlns="http://www.w3.org/2000/svg" width="2.262ex" height="1.181ex" role="img" focusable="false" viewBox="0 -511 1000 522" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">→</mo></math></mjx-assistive-mml></mjx-container> UserID und Timestamp sollten als Schutz vor <strong>Replay Angriffen</strong> geprüft werden</li></ul></li><li><strong>Custom Request Headers</strong> (REST Services) <ul><li>eigener Header, z.B. X-Requested-With: XMLHttpRequest</li><li>Same-Origin Policy <ul><li>nur JavaScript in der selben Domain (Same-Origin) könnte den Header hinzufügen</li><li>Browser verbietet JavaScript über verschiedene Domains standardmäßig</li></ul></li><li>eingeschränkt empfohlen</li></ul></li><li><strong>SameSite</strong> Cookie Attribut <ul><li>Verhindert Zugriff auf Cookie bei CSRF</li></ul></li><li><strong>HttpOnly</strong> Attribut <ul><li>Verhindert Zugriff mit JavaScript, eingeschränkte Wirksamkeit</li></ul></li><li><strong>Challenge Response</strong><ul><li>individuelle &quot;Aufgabe&quot;, Lösung durch Client: CAPTCHA, Re-Authentication, One-Time-Token</li><li>sehr wirkungsvoll, aber weder benutzerfreundlich noch barrierefrei</li></ul></li><li>Maßnahmen des <strong>Benutzers</strong><ul><li>Logout verwenden</li><li>keine Anmeldedaten im Browser speichern</li><li>keine Anmeldedaten in Seite speichern</li><li>ggf. mehrere Browser für verschiedene Sicherheitslevel</li><li>Deaktivierung von JavaScript im Browser</li></ul></li></ul><h2 id="_02-cryptographic-failures" tabindex="-1"><a class="header-anchor" href="#_02-cryptographic-failures"><span>02 Cryptographic Failures</span></a></h2><p>Unbeabsichtigte Offenlegung vertraulicher Informationen: Passwörter, personenbezogene Daten, Finanzdaten</p><ul><li><strong>Kein Schutz</strong><ul><li>Speicherung im Klartext</li><li>Verschlüsselte Speicherung aber Entschlüsselung bei jedem Zugriff (SQLI)</li><li>Übertragung im Klartext (auch durch Downgrade-Attacke)</li><li>Ungeschütztes Backup</li></ul></li><li><strong>Kein ausreichender Schutz</strong><ul><li>Passwort-Hashes ohne Salz</li><li>Verwendung schwacher Krypto-Algorithmen</li></ul></li></ul><h3 id="gegenmaßnahmen-gegen-cryptographic-failures" tabindex="-1"><a class="header-anchor" href="#gegenmaßnahmen-gegen-cryptographic-failures"><span>Gegenmaßnahmen gegen Cryptographic Failures</span></a></h3><ul><li>Geeignete Speicherung: vertrauliche Daten <strong>verschlüsselt</strong> bzw. Passwörter <strong>gehasht</strong> (und gesalzen)</li><li>Reduzierung der gespeicherten vertraulichen Daten <mjx-container class="MathJax" jax="SVG" style="position:relative;"><svg style="vertical-align:-0.025ex;" xmlns="http://www.w3.org/2000/svg" width="2.262ex" height="1.181ex" role="img" focusable="false" viewBox="0 -511 1000 522" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">→</mo></math></mjx-assistive-mml></mjx-container> &quot;Data you don&#39;t have can&#39;t be stolen&quot;</li><li>Falls möglich: <strong>Hardware-Sicherheitsmodul</strong> (HSM)verwenden</li><li>Starke Passwörter erzwingen</li><li>Keine Auto-Vervollständigung sensitiver Informationen</li></ul><h3 id="sichere-kryptographische-speicherung" tabindex="-1"><a class="header-anchor" href="#sichere-kryptographische-speicherung"><span>Sichere kryptographische Speicherung</span></a></h3><p>Nach OWASP &quot;Cryptographic Storage Cheat Sheet&quot;</p><ul><li>1: <strong>nur benötigte</strong> Daten speichern</li><li>2: Verwendung <strong>starker</strong> kryptografischer Algorithmen <ul><li>AES, RSA, SHA-256, CCM, GCM</li><li><ins>NICHT</ins>: MD5, SHA1</li><li>kann sich ändern, auf Empfehlungen des BSI achten</li><li>Seed muss genügend <strong>Entropie</strong> haben</li><li>nur bekannte und anerkannte Implementierungen verwenden</li></ul></li><li>3: Passwörter in <strong>mehreren Iterationen</strong> hashen und salzen <ul><li>pbkdf2, bcrypt, scrypt, argon2</li></ul></li><li>4: <strong>Sicherheit</strong> muss <strong>immer gewährleistet</strong> sein (principle of defense in depth) <ul><li>verschiedene Layer von Security</li></ul></li><li>5: Geheime <strong>Schlüssel</strong> vor unbefugtem Zugriff <strong>schützen</strong><ul><li>Key Lifecycle (regelmäßiges Rekeying, max. nach einem Jahr &quot;umschlüsseln&quot;)</li><li>nicht am selben Ort wie Daten speichern</li><li>bei mehreren Schlüsseln: Unabhängigkeit</li><li>an sicherem Ort</li><li>Menge pro Schlüssel limitieren</li><li>Prozedur bei kompromittiertem Schlüssel dokumentieren</li></ul></li></ul><h3 id="verwendung-von-ssl-tls-by-design" tabindex="-1"><a class="header-anchor" href="#verwendung-von-ssl-tls-by-design"><span>Verwendung von SSL / TLS (by Design)</span></a></h3><p>Nach OWASP &quot;Transport Layer Protection Cheat Sheet&quot;</p><ul><li>1: für <strong>alle Seiten</strong> aktivieren</li><li>2: bei vertraulichen Daten auch in internen Netzen</li><li>3: wenn SSL / TLS zur Verfügung steht, dann <strong>erzwingen</strong></li><li>4: ausschließlich Inhalte über SSL / TLS einbinden</li><li>5: <strong>Secure Cookie Flag</strong> verwenden: Übertragung nur per SSL / TLS</li><li>6: keine sensitiven Daten <strong>in URLs</strong></li><li>7: <strong>Kein Caching</strong> sensitiver Daten</li><li>8: <strong>HTTP Strict Transport Security</strong> (HSTS) nutzen <ul><li>erzwungenes https</li><li>ungültige Zertifikate können nicht akzeptiert werden</li></ul></li></ul><h4 id="certificate-transparency-ct" tabindex="-1"><a class="header-anchor" href="#certificate-transparency-ct"><span>Certificate Transparency (CT)</span></a></h4><ul><li>unveränderbares Logfile, das alle ausgestellten <strong>Zertifikate</strong> einer <strong>CA</strong> (Certificate Authority) enthält</li></ul><h4 id="certificate-authority-authorization-caa" tabindex="-1"><a class="header-anchor" href="#certificate-authority-authorization-caa"><span>Certificate Authority Authorization (CAA)</span></a></h4><ul><li><strong>DNS-Eintrag</strong>, wer zu einer Domäne Zertifikate erstellen darf</li></ul><h4 id="ssl-tls-server-zertifikate" tabindex="-1"><a class="header-anchor" href="#ssl-tls-server-zertifikate"><span>SSL / TLS Server-Zertifikate</span></a></h4><ul><li>nur geschützte, <strong>starke Schlüssel</strong></li><li><strong>geeignete CA</strong> verwenden</li><li>Fully Qualified Domain Names (<strong>FQDN</strong>) in DNS verwenden</li><li>keine Wildcard-Zertifikate (Verstoß gegen &quot;least privilege principle&quot;)</li><li>keine lokalen IP-Adressen als FQDN oder Subject Alternate Names (SAN) verwenden</li><li>alle benötigten Zertifikate zur Validierung sollen ausgeliefert werden</li></ul><h4 id="ssl-tls-protokolle-und-chiffren" tabindex="-1"><a class="header-anchor" href="#ssl-tls-protokolle-und-chiffren"><span>SSL / TLS Protokolle und Chiffren</span></a></h4><ul><li>nur kryptografisch <strong>starke Protokolle</strong> &amp; Chiffren bzw. <strong>Cipher Suites</strong> (Kombination kryptographischer Verfahren) verwenden <ul><li>AES, 3-key 3DES, CBC mode</li><li>AES/CTR</li><li>SHA2</li><li>Ephemeral Diffie-Hellman für Schlüsselaustausch</li></ul></li><li><ins>NICHT</ins>: <ul><li>Cipher Suites ohne Authentication (NULL, aNULL, eNULL)</li><li>Anonymous Diffie-Hellman (ADH)</li><li>Export Level Cipher (EXP)</li><li>Schlüssellänge &lt; 128 Bit</li><li>MD5</li></ul></li><li>flüchtige Session-Keys verwenden <mjx-container class="MathJax" jax="SVG" style="position:relative;"><svg style="vertical-align:-0.025ex;" xmlns="http://www.w3.org/2000/svg" width="2.262ex" height="1.181ex" role="img" focusable="false" viewBox="0 -511 1000 522" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">→</mo></math></mjx-assistive-mml></mjx-container> <strong>Perfect Forward Secrecy</strong> (PFS)</li><li>Schwächen des TLS vermeiden <ul><li>Kompression abschalten (exploitbar)</li><li>TLS Renegotiation abschalten bzw. Secure Renegotiation verwenden (expolitbar)</li></ul></li><li>aktuelle Versionen verwenden</li></ul><h2 id="_03-injection-angriffe" tabindex="-1"><a class="header-anchor" href="#_03-injection-angriffe"><span>03 Injection-Angriffe</span></a></h2><p>Umfasst seit 2021 auch Cross Site Scripting (XSS)</p><ul><li><strong>SQL Injection</strong></li><li>Format String</li><li>Command Injection</li><li>Log Injection</li><li>Reflection Injection</li><li>Interpreter Injection</li><li><strong>eXternal XML Entities</strong> (<mjx-container class="MathJax" jax="SVG" style="position:relative;"><svg style="vertical-align:-0.025ex;" xmlns="http://www.w3.org/2000/svg" width="2.262ex" height="1.181ex" role="img" focusable="false" viewBox="0 -511 1000 522" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">→</mo></math></mjx-assistive-mml></mjx-container> Security Misconfiguration)</li><li>XSS (<strong>stored, reflected, dom-based, mutated</strong>)</li></ul><h3 id="sql-injection" tabindex="-1"><a class="header-anchor" href="#sql-injection"><span>SQL Injection</span></a></h3><p>Wenn dynamische Datenbank-Abfrage mit (ungeprüfter) Benutzereingabe gebildet wird</p><ul><li>kann Logik der Abfrage ändern</li><li>kann Datenbank beschädigen (Inhalte löschen) oder vertrauliche Daten preisgeben</li></ul><h4 id="beispiele" tabindex="-1"><a class="header-anchor" href="#beispiele"><span>Beispiele</span></a></h4><ul><li><code>&#39;</code> <mjx-container class="MathJax" jax="SVG" style="position:relative;"><svg style="vertical-align:-0.025ex;" xmlns="http://www.w3.org/2000/svg" width="2.262ex" height="1.181ex" role="img" focusable="false" viewBox="0 -511 1000 522" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">→</mo></math></mjx-assistive-mml></mjx-container> Fehler 500 (Syntaxfehler wegen zusätzlichem Anführungszeichen) <mjx-container class="MathJax" jax="SVG" style="position:relative;"><svg style="vertical-align:-0.025ex;" xmlns="http://www.w3.org/2000/svg" width="2.262ex" height="1.181ex" role="img" focusable="false" viewBox="0 -511 1000 522" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">→</mo></math></mjx-assistive-mml></mjx-container> verwundbar für SQL Injection</li><li><code>&#39; OR &#39;x&#39;=&#39;x</code> <mjx-container class="MathJax" jax="SVG" style="position:relative;"><svg style="vertical-align:-0.025ex;" xmlns="http://www.w3.org/2000/svg" width="2.262ex" height="1.181ex" role="img" focusable="false" viewBox="0 -511 1000 522" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">→</mo></math></mjx-assistive-mml></mjx-container> kann bei einem SELECT alle Elemente selektieren</li><li><code>&#39; AND email IS NULL;--</code> <mjx-container class="MathJax" jax="SVG" style="position:relative;"><svg style="vertical-align:-0.025ex;" xmlns="http://www.w3.org/2000/svg" width="2.262ex" height="1.181ex" role="img" focusable="false" viewBox="0 -511 1000 522" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">→</mo></math></mjx-assistive-mml></mjx-container> wird nie wahr, aber falls kein Fehler 500 kommt existiert das Feld, hier <em>email</em></li><li><code>&#39; AND 1=(SELECT COUNT(*) FROM tabname);--</code> oder <code>&#39; AND member.email is NULL</code> <mjx-container class="MathJax" jax="SVG" style="position:relative;"><svg style="vertical-align:-0.025ex;" xmlns="http://www.w3.org/2000/svg" width="2.262ex" height="1.181ex" role="img" focusable="false" viewBox="0 -511 1000 522" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">→</mo></math></mjx-assistive-mml></mjx-container> ebenfalls Erraten eines Feldnamen</li><li><code>&#39; OR full_name LIKE &#39;%Alice%</code> <mjx-container class="MathJax" jax="SVG" style="position:relative;"><svg style="vertical-align:-0.025ex;" xmlns="http://www.w3.org/2000/svg" width="2.262ex" height="1.181ex" role="img" focusable="false" viewBox="0 -511 1000 522" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">→</mo></math></mjx-assistive-mml></mjx-container> Überprüfung auf teilweise Übereinstimmung</li><li><code>alice@example.com&#39; AND passwd=&#39;geraten</code> <mjx-container class="MathJax" jax="SVG" style="position:relative;"><svg style="vertical-align:-0.025ex;" xmlns="http://www.w3.org/2000/svg" width="2.262ex" height="1.181ex" role="img" focusable="false" viewBox="0 -511 1000 522" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">→</mo></math></mjx-assistive-mml></mjx-container> Erraten eines Passworts</li><li><code>&#39;; DROP TABLE members; --</code> <mjx-container class="MathJax" jax="SVG" style="position:relative;"><svg style="vertical-align:-0.025ex;" xmlns="http://www.w3.org/2000/svg" width="2.262ex" height="1.181ex" role="img" focusable="false" viewBox="0 -511 1000 522" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">→</mo></math></mjx-assistive-mml></mjx-container> beliebiges eigenes Statement durch Konkatenation</li><li><strong>UNION ALL</strong>: Vereinigung anderer Tabelle, auch mit unterschiedlichen Datentypen, lediglich Spaltenanzahl muss gleich sein</li><li><strong>LOAD_FILE()</strong>: kann lokale Datei ausgeben, wenn diese für alle Benutzer lesbar ist</li><li><strong>INTO OUTFILE()</strong>: schreibt Ergebnis in Datei, Verzeichnis muss schreibbar sein</li><li><strong>LIMIT</strong> position, anzahl: auch wenn nur das erste Element gezeigt wird, ist Iteration möglich</li></ul><h4 id="blind-sql-injection" tabindex="-1"><a class="header-anchor" href="#blind-sql-injection"><span>Blind SQL Injection</span></a></h4><ul><li><strong>Partially Blind Injection</strong>: leicht abweichendes Verhalten bei Erfolg / Misserfolg</li><li><strong>Totally Blind Injection</strong>: kein Unterschied in Ausgabe, Erfolg nur schwer feststellbar</li></ul><p>Hier kann das Zeitverhalten ausgenutzt werden</p><ul><li>MySQL:</li></ul><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">UNION ALL</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> SELECT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> BENCHMARK(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1000000</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, MD5(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">CHAR</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">118</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)))</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>MSSQL:</li></ul><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">WAITFOR</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> DELAY</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;0:0:10&#39;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">--</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>PostgreSQL:</li></ul><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">SELECT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> pg_sleep(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="vermeidung-von-sql-injection" tabindex="-1"><a class="header-anchor" href="#vermeidung-von-sql-injection"><span>Vermeidung von SQL Injection</span></a></h4><ul><li><strong>Safe API</strong> / ORM Tools <ul><li>parametrisiertes Interface oder objektrelationales Mapping</li></ul></li><li><strong>Server Side Input Validation</strong> (Whitelisting) <ul><li>nicht immer möglich</li><li>gut geeignet für strukturierte Daten wie E-Mail-Adressen oder Telefonnummern</li></ul></li><li><strong>Prepared Statements</strong> (Parameterized Queries) <ul><li>Platzhalter werden validiert und befüllt</li><li>Unterschied zwischen Code und Daten klar sichtbar</li><li>können anfällig sein</li></ul></li><li><strong>Stored Procedures</strong><ul><li>Vorkompilierter Code in Datenbank</li><li>Lediglich Übergabe von Funktionsname und Parametern, auch hier Unterschied zwischen Code und Daten klar</li><li>können anfällig sein, wenn dynamisches SQL erzeugt wird</li></ul></li><li><strong>Escaping</strong> von Benutzereingaben <ul><li>nur für Legacy Code wenn Änderung zu aufwendig oder Performance Probleme</li><li>vorhandene Bibliotheken nutzen, da Implementierung sehr schwierig</li></ul></li></ul><p>Zusätzlich sollte das <strong>Least Privilege Principle</strong> angewandt werden: nur minimale Rechte vergeben um möglichen Schaden zu begrenzen</p><h3 id="_07-2017-cross-site-scripting" tabindex="-1"><a class="header-anchor" href="#_07-2017-cross-site-scripting"><span>07/2017 Cross Site Scripting</span></a></h3><p>Gefährdung wenn Input (von Benutzer oder Datenbank) in dynamische Inhalte eingebunden wird, die an den Browser eines Benutzers gesendet werden</p><p>Verschiedene Arten:</p><ul><li>Drive-By <ul><li><strong>Stored XSS</strong>: feindlicher Code wird permanent auf Server gespeichert (Datenbank, Forum, Kommentare, ...) <mjx-container class="MathJax" jax="SVG" style="position:relative;"><svg style="vertical-align:-0.025ex;" xmlns="http://www.w3.org/2000/svg" width="2.262ex" height="1.181ex" role="img" focusable="false" viewBox="0 -511 1000 522" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">→</mo></math></mjx-assistive-mml></mjx-container> wird an alle Clients verteilt</li></ul></li><li>Social Engineering <ul><li><strong>Reflected XSS</strong>: feindlicher Code wird reflektiert durch Fehlermeldungen, Suchergebnisse, etc. <ul><li>über Link in E-Mail oder anderen Webserver</li></ul></li><li><strong>DOM-based XSS</strong>: Manipulation des DOM beim Opfer <mjx-container class="MathJax" jax="SVG" style="position:relative;"><svg style="vertical-align:-0.025ex;" xmlns="http://www.w3.org/2000/svg" width="2.262ex" height="1.181ex" role="img" focusable="false" viewBox="0 -511 1000 522" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">→</mo></math></mjx-assistive-mml></mjx-container> Nutzung des originalen Codes auf unbeabsichtigte Weise <ul><li>im Gegensatz zu Stored / Reflected lediglich Änderungen im Client</li></ul></li></ul></li><li><strong>Mutation XSS</strong> (mXSS)</li></ul><h4 id="gegenmaßnahmen-zu-stored-reflected-xss" tabindex="-1"><a class="header-anchor" href="#gegenmaßnahmen-zu-stored-reflected-xss"><span>Gegenmaßnahmen zu Stored / Reflected XSS</span></a></h4><ul><li>nie nicht-vertrauenswürdige Daten einfügen (außer erlaubte Bereiche)</li><li><strong>Escaping</strong> von User Input</li><li><strong>HTML Policy Engine</strong>: Bereinigung von User Input</li></ul><h4 id="gegenmaßnahmen-zu-dom-based-xss" tabindex="-1"><a class="header-anchor" href="#gegenmaßnahmen-zu-dom-based-xss"><span>Gegenmaßnahmen zu DOM-based XSS</span></a></h4><ul><li>Encoding und dessen Reihenfolge beachten</li><li>Vorsichtiges Vorgehen beim Einfügen von JavaScript</li><li>nicht-vertrauenswürdige Daten immer als darstellbaren Text behandeln</li><li>Vermeidung gefährlicher Methoden wie implizites eval() <ul><li>direktes Setzen von HTML Code: element.innerHTML, document.write(), ...</li></ul></li><li>Verständnis für Datenfluss</li></ul><h2 id="_04-insecure-design" tabindex="-1"><a class="header-anchor" href="#_04-insecure-design"><span>04 Insecure Design</span></a></h2><p>Schwachstellen in Architektur und Design <mjx-container class="MathJax" jax="SVG" style="position:relative;"><svg style="vertical-align:-0.025ex;" xmlns="http://www.w3.org/2000/svg" width="2.262ex" height="1.181ex" role="img" focusable="false" viewBox="0 -511 1000 522" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">→</mo></math></mjx-assistive-mml></mjx-container> <strong>Secure by Design</strong></p><ul><li>mehr Bedrohungsmodellierung</li><li>sichere Design Patterns</li><li>Verwendung von Referenzarchitekturen</li></ul><p>Requirements and Resource Management</p><ul><li>Schutzziele und Exponiertheit von Anwendungen</li><li>Security Requirements &amp; Budget</li></ul><h3 id="secure-design" tabindex="-1"><a class="header-anchor" href="#secure-design"><span>Secure Design</span></a></h3><p>Kultur &amp; Methodik für robusten Code</p><h4 id="secure-development-lifecycle" tabindex="-1"><a class="header-anchor" href="#secure-development-lifecycle"><span>Secure Development Lifecycle</span></a></h4><ul><li>Durchgängiges Involvieren von Security-ExpertInnen</li><li>Library Management &amp; Security Design Patterns</li><li>Unit- und Integrationstests (v.a. für kritische Abläufe)</li><li>Robuste Trennung von Mandanten / Schutzbedarf</li><li>Begrenzung des Ressourcenverbrauchs nach Benutzer / Dienst</li></ul><h3 id="bedrohungsanalyse" tabindex="-1"><a class="header-anchor" href="#bedrohungsanalyse"><span>Bedrohungsanalyse</span></a></h3><p>Erfassung von technischen, organisatorischen und benutzerbedingten Bedrohungen in einer <strong>Bedrohungsmatrix</strong> (Gefährdungsbereiche &amp; Auslöser) oder einem <strong>Bedrohungsbaum</strong> (Wurzel als mögliches Angriffsziel, Knoten als Zwischenziele zum Erreichen des Elternknoten, Verknüpfung mit UND bzw. ODER)</p><h4 id="klassifikation-nach-stride" tabindex="-1"><a class="header-anchor" href="#klassifikation-nach-stride"><span>Klassifikation nach STRIDE</span></a></h4><p>Spoofing Tampering Repudiation Information disclosure Denial of service Elevation of privilege</p><h4 id="risikoanalyse" tabindex="-1"><a class="header-anchor" href="#risikoanalyse"><span>Risikoanalyse</span></a></h4><p>Eintrittswahrscheinlichkeit &amp; Schwere des Schadens</p><p>Eintrittswahrscheinlichkeit abhängig von</p><ul><li>Aufwand des Angriffs</li><li>möglicher Nutzen des Angriffs</li><li>mögliches Schadensausmaß</li><li>Fähigkeiten und Risikobereitschaft der Angreifer</li></ul><p>Sicherheitsdesigner muss erfinderischer sein als Angreifer</p><h4 id="sicherheitsstrategie-und-modell" tabindex="-1"><a class="header-anchor" href="#sicherheitsstrategie-und-modell"><span>Sicherheitsstrategie und -modell</span></a></h4><p>Aus den Ergebnissen der Risikoanalyse, Ermittelung von Maßnahmen zur Abwehr der Bedrohungen</p><p><strong>Design Patterns</strong> für wiederholt auftretende Probleme</p><h3 id="security-patterns" tabindex="-1"><a class="header-anchor" href="#security-patterns"><span>Security Patterns</span></a></h3><h4 id="einzelner-zugriffspunkt" tabindex="-1"><a class="header-anchor" href="#einzelner-zugriffspunkt"><span>Einzelner Zugriffspunkt</span></a></h4><ul><li>externer Zugriff auf ein System</li><li>Schutz vor Missbrauch und Schaden im Fokus</li><li>einfach anwendbarer, einzelner Zugriff zum System</li><li>Zugriff kann <strong>erlaubt oder verweigert</strong> werden</li></ul><h4 id="check-point" tabindex="-1"><a class="header-anchor" href="#check-point"><span>Check Point</span></a></h4><ul><li>Erweiterung des Einzelnen Zugriffspunktes</li><li>Erkennen und <strong>Melden von Angriffen</strong></li><li>legitimer Zugriff soll aber nicht beeinträchtigt werden</li><li>Vorteile <ul><li>konkrete, anpassbare Sicherheitspolicy</li><li>unabhängige Tests verschiedener Policies</li></ul></li><li>Nachteile <ul><li>Fehler / Sicherheitslücken in der Implementierung gefährden das gesamte System</li><li>Erkennung unnatürlichen Nutzerverhaltens oft sehr aufwändig</li><li>Konfiguration kann sehr aufwändig werden</li></ul></li></ul><h4 id="security-session" tabindex="-1"><a class="header-anchor" href="#security-session"><span>Security Session</span></a></h4><ul><li>an Benutzer-Session gekoppelte Security Session, die über SessionID referenziert wird</li><li>beinhaltet z.B. Zugriffsberechtigungen</li><li>bei entsprechenden Anfragen wird die Zugriffsberechtigung in der Security Session geprüft</li><li>Vorteile <ul><li>einfacher, spezifischer Zugriffspunkt</li><li>einfach erweiterbar</li><li>Caching <mjx-container class="MathJax" jax="SVG" style="position:relative;"><svg style="vertical-align:-0.025ex;" xmlns="http://www.w3.org/2000/svg" width="2.262ex" height="1.181ex" role="img" focusable="false" viewBox="0 -511 1000 522" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">→</mo></math></mjx-assistive-mml></mjx-container> Performance</li></ul></li><li>Nachteile <ul><li>Globale Objekte meist unerwünscht</li><li>Austausch von großen Objekten schwierig: geht auf Performance, muss sicher übertragen werden</li><li>nachträgliches Hinzufügen zu einem System kann sehr aufwändig sein</li></ul></li></ul><h4 id="vollzugriff-mit-fehlern" tabindex="-1"><a class="header-anchor" href="#vollzugriff-mit-fehlern"><span>Vollzugriff mit Fehlern</span></a></h4><ul><li>Oberfläche stellt alle Funktionalitäten dar (keine versteckten Elemente)</li><li>vor einer Ausführung muss Zugriffsberechtigung geprüft werden</li><li>im Verbotsfall soll eine Fehlermeldung erscheinen (einheitliche Fehlerbehandlung)</li><li>dem Nutzer sollte ersichtlich sein, welche Aktionen erlaubt sind</li><li>Vorteile <ul><li>konsistente Oberfläche</li><li>einfache Integration</li></ul></li><li>Nachteile <ul><li>Frustration wenn nicht ganz klar ist, was erlaubt ist</li><li>aufwendig, weil immer geprüft werden muss</li><li>Oberfläche kann aufgebläht wirken</li></ul></li></ul><h4 id="begrenzter-zugriff" tabindex="-1"><a class="header-anchor" href="#begrenzter-zugriff"><span>Begrenzter Zugriff</span></a></h4><p>Gegenteil von Vollzugriff mit Fehlern</p><ul><li>nur ausführbare Funktionalität wird angezeigt</li><li>Vorteile <ul><li>übersichtliche Oberfläche</li></ul></li><li>Nachteile <ul><li>angepasste Trainings für verschiedene Nutzerkreise</li><li>Implementierung der Zugriffsberechtigung in der Oberfläche vergrößert den Angriffsvektor</li></ul></li></ul><h3 id="sicherheit-in-internet-anwendungen" tabindex="-1"><a class="header-anchor" href="#sicherheit-in-internet-anwendungen"><span>Sicherheit in Internet Anwendungen</span></a></h3><h4 id="information-obscurity" tabindex="-1"><a class="header-anchor" href="#information-obscurity"><span>Information Obscurity</span></a></h4><ul><li>Verschleierung sensitiver Daten: Versionsnummer, geöffnete Ports, ...</li><li>wenn möglich ohne Verschlüsselung (Zeitfaktor)</li><li>nach Wichtigkeit klassifizieren und wichtigste Daten verschlüsseln</li><li>Vorteile <ul><li>Erhöhung der Informationssicherheit</li><li>wichtige Daten für einen Angriff sind nur schwer identifizierbar</li></ul></li><li>Nachteile <ul><li>Beeinträchtigung der Performance</li><li>schlechtere Wartbarkeit</li><li>aufwändigere Programmierung</li></ul></li></ul><h4 id="sichere-kanale" tabindex="-1"><a class="header-anchor" href="#sichere-kanale"><span>Sichere Kanäle</span></a></h4><p>Sichere Kanäle für kritische Daten, damit diese nicht ausspioniert werden können</p><ul><li>Verschlüsselung ist starker Overhead</li><li>Vorteile <ul><li>ohne weitere Kenntnisse sind mitgelesene Daten nutzlos</li><li>Schlüsselaustausch-Verfahren ermöglichen eine sichere Verbindung, wenn sich Gesprächspartner nicht kennen</li></ul></li><li>Nachteile <ul><li>kostet Performance</li><li>kann Verfügbarkeit einschränken</li><li>erhöhte Instandhaltungskosten</li></ul></li></ul><h4 id="known-partners" tabindex="-1"><a class="header-anchor" href="#known-partners"><span>Known Partners</span></a></h4><p>Beide Gesprächspartner können sich gegenseitig eindeutig identifizieren</p><ul><li>Schutz vor Identitätsdiebstahl</li><li>gegenseitiger Nachweis, Kommunikation über sichere Kanäle</li><li>Vorteile <ul><li>dem system ist bekannt, wer agiert</li><li>der Nutzer kann das System eindeutig erkennen und Fälschungen identifizieren</li></ul></li><li>Nachteile <ul><li>schlechtere Performance</li><li>schlechtere Wartbarkeit</li><li>Verfügbarkeit kann beeinträchtigt sein</li></ul></li></ul><h4 id="demilitarisierte-zone-dmz" tabindex="-1"><a class="header-anchor" href="#demilitarisierte-zone-dmz"><span>Demilitarisierte Zone (DMZ)</span></a></h4><p>Trennt Business Funktionalität von Webservern, welche diese ausliefern</p><ul><li>reduziert die Angriffsfläche</li><li>erschwert das unerlaubte Eindringen in ein System</li><li>Vorteile <ul><li>weniger Systeme können direkt angegriffen werden</li></ul></li><li>Nachteile <ul><li>Firewall als &quot;Single Point of Failure&quot;</li><li>höhere Wartungskosten</li><li>kann Performance beeinträchtigen</li></ul></li></ul><h4 id="protection-reverse-proxy" tabindex="-1"><a class="header-anchor" href="#protection-reverse-proxy"><span>Protection Reverse Proxy</span></a></h4><p>Schützt eine Anwendung auf Software Protokoll Ebene</p><ul><li>Vorteile <ul><li>macht es schwerer Schwachstellen im Backend Server direkt auszunutzen</li><li>einfacheres Patchmanagement, da nur eine Maschine mit dem Internet verbunden ist</li></ul></li><li>Nachteile <ul><li>Block List Filter können trügerische Sicherheit darstellen</li><li>Allow List Filter schränken in der Regel erheblich ein</li><li>&quot;Single Point of Failure&quot;</li></ul></li></ul><h4 id="integration-reverse-proxy" tabindex="-1"><a class="header-anchor" href="#integration-reverse-proxy"><span>Integration Reverse Proxy</span></a></h4><p>Homogene Sicht auf verteilte Systeme einer Domäne</p><ul><li>Vorteile <ul><li>ein Server, eine IP-Adresse</li><li>einfache Erweiterung möglich</li><li>Load Balancing möglich</li><li>zentralisiertes Logging möglich</li></ul></li><li>Nachteile <ul><li>&quot;Single Point of Failure&quot;</li><li>Beschränkung max. paralleler Verbindungen</li><li>Schwierigkeit: Session-Management</li></ul></li></ul><h4 id="front-door" tabindex="-1"><a class="header-anchor" href="#front-door"><span>Front Door</span></a></h4><p>Idealer Einstiegspunkt für Authentifizierung / Autorisierung, ebenfalls ein Reverse Proxy</p><ul><li>Vorteile <ul><li>&quot;Single Sign On&quot; möglich</li><li>ein Benutzerprofil für diverse Backend Anwendungen</li><li>Backend Server müssen sich nicht um Authentifizierung kümmern</li><li>ermöglicht zentralisiertes Logging</li></ul></li><li>Nachteile <ul><li>Inkonsistenzen möglich wenn bestimmte zusätzliche Nutzerdaten auf Backend Servern gespeichert werden müssen</li><li>verschiedene Richtlinien / Vorgaben müssen unter einen Hut gebracht werden</li></ul></li></ul><h2 id="_05-security-misconfiguration" tabindex="-1"><a class="header-anchor" href="#_05-security-misconfiguration"><span>05 Security Misconfiguration</span></a></h2><p>Robuste Konfiguration dämmt Auswirkungen erfolgreicher Angriffe ein (&quot;least privilege&quot;)</p><p>Umfasst</p><ul><li>Anwendungen</li><li>Frameworks</li><li>Web Server</li><li>Datenbank Server</li><li>Plattform</li></ul><p>und regelmäßiges Patchen</p><p>Beinhaltet seit 2021 auch XML eXternal Entities (XXE)</p><h3 id="sichere-konfiguration" tabindex="-1"><a class="header-anchor" href="#sichere-konfiguration"><span>Sichere Konfiguration</span></a></h3><ul><li>keine unnötige Veröffentlichung interner Informationen <ul><li>Fehlerausgabe</li><li>Versionsnummer</li><li>Banner</li></ul></li><li>Default Accounts deaktivieren</li><li>Frameworks beachten</li><li>feingranulare Rechte, möglichst eingeschränkt (&quot;least privilege&quot;)</li><li>Security Guide berücksichtigen</li><li>Logging aktivieren</li><li>Sichere Speicherung von Passwörtern</li></ul><h4 id="sichere-konfiguration-von-webservern" tabindex="-1"><a class="header-anchor" href="#sichere-konfiguration-von-webservern"><span>Sichere Konfiguration von Webservern</span></a></h4><ul><li>Zugriffsrechte des Web-Server Nutzer-Accounts beschränken</li><li>Fehlerausgaben minimieren bzw. verallgemeinern</li><li>Programme und Daten in verschiedenen Verzeichnissen (heute nicht mehr so wichtig)</li><li>geeignete Protokollierung</li></ul><h4 id="sichere-konfiguration-von-datenbankservern" tabindex="-1"><a class="header-anchor" href="#sichere-konfiguration-von-datenbankservern"><span>Sichere Konfiguration von Datenbankservern</span></a></h4><ul><li>nicht mit DB-Admin arbeiten <ul><li>eigener Account pro Anwendung</li></ul></li><li>DB-Admin Passwort setzen</li><li>wo möglich nur Zugriff über localhost</li><li>Zugriff auf Systemtabellen begrenzen / verbieten</li></ul><h3 id="xml-external-entities-xxe" tabindex="-1"><a class="header-anchor" href="#xml-external-entities-xxe"><span>XML eXternal Entities (XXE)</span></a></h3><p>XML-Format wird für Datenaustausch verwendet</p><p>Schwachstelle, wenn XML ungeprüft vom Server ausgewertet wird</p><p><strong>XML Entitäten</strong> werden in <strong>Document Type Declaration</strong> (DTD) als Tags definiert</p><ul><li><strong>Classic</strong>: external Entity wird in lokales DTD eingefügt</li><li><strong>Blind</strong>: keine Ausgabe oder Error Message</li><li><strong>Error</strong>: gewünschten Inhalt in Error Message erhalten</li></ul><p>Typen von Entitäten</p><ul><li><strong>General Entities</strong></li></ul><div class="language-xml line-numbers-mode" data-highlighter="shiki" data-ext="xml" data-title="xml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;!ENTITY name &quot;Hello World&quot;&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li><strong>Parameter Entities</strong> (können weitere Entities enthalten)</li></ul><div class="language-xml line-numbers-mode" data-highlighter="shiki" data-ext="xml" data-title="xml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;!ENTITY % name &quot;Hello World&quot;&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;!ENTITY % name &quot;Hello %myEntity;&quot;&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>External Entities</strong> (können externe Ressourcen einbinden, auch im DOCTYPE möglich)</li></ul><div class="language-xml line-numbers-mode" data-highlighter="shiki" data-ext="xml" data-title="xml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;!ENTITY name SYSTEM &quot;URI/URL&quot;&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;!ENTITY name PUBLIC &quot;any_text&quot; &quot;URI/URL&quot;&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;!</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">DOCTYPE</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> SYSTEM &quot;address.dtd&quot; </span><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;">[</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">...</span><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;">]</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;!</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">DOCTYPE</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> PUBLIC &quot;any_text&quot; &quot;http://evil.com/evil.dtd&quot;&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Beispiel (Definition und Zugriff auf eine Entität):</p><div class="language-xml line-numbers-mode" data-highlighter="shiki" data-ext="xml" data-title="xml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;?</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">xml</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> version</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;1.0&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> standalone</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;yes&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ?&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  &lt;!</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">DOCTYPE</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> author</span><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;"> [</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;!ELEMENT author (#PCDATA)&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;!</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">ENTITY</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> js</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;Jo Smith&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;">  ]</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">author</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">&amp;</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">js</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">author</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Beispiel geänderter XML Request für Zugriff auf /etc/passwd:</p><div class="language-xml line-numbers-mode" data-highlighter="shiki" data-ext="xml" data-title="xml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;?</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">xml</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> version</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;1.0&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> encoding</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;ISO-8859-1&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ?&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  &lt;!</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">DOCTYPE</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> foo</span><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;"> [</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;!ELEMENT foo ANY&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;!</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">ENTITY</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> xxe</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> SYSTEM </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;file:///etc/passwd&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;">  ]</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">foo</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">&amp;</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">xxe</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">foo</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="schwachstelle-bei-xml-erkennen" tabindex="-1"><a class="header-anchor" href="#schwachstelle-bei-xml-erkennen"><span>Schwachstelle bei XML erkennen</span></a></h4><ul><li>Mit Metacharakteren auf XML Injection testen <ul><li>&#39;, &quot;, &lt;&gt;, &lt;!--/--&gt;, &amp;, &lt;![CDATA[ / ]]&gt;</li></ul></li><li>ein einfaches Beispiel testen</li><li>Tag Injection: Eingabe von XML Tags in Eingabefelder testen</li></ul><h4 id="mogliche-auswirkungen-von-xxe" tabindex="-1"><a class="header-anchor" href="#mogliche-auswirkungen-von-xxe"><span>Mögliche Auswirkungen von XXE</span></a></h4><ul><li>Zugriff auf Ressourcen eines lokalen Netzwerks</li><li>Remote Code Execution (eher selten)</li><li>Denial-of-Service (DoS)</li></ul><h4 id="gegenmaßnahmen-gegen-xxe" tabindex="-1"><a class="header-anchor" href="#gegenmaßnahmen-gegen-xxe"><span>Gegenmaßnahmen gegen XXE</span></a></h4><ul><li>DTDs External Entities vollständig deaktivieren</li><li>Alternativ Unterbindung der Auflösung von &quot;External Entities&quot;</li><li>auch die Content-Type und Accept Headers validieren</li><li>Benutzereingaben, die zu XML geparst werden immer server-seitig mit Allowlist validieren</li><li>böswillige Anfragen mit &quot;406/Not Acceptable&quot; beantworten</li></ul><h2 id="_06-vulnerable-and-outdated-components" tabindex="-1"><a class="header-anchor" href="#_06-vulnerable-and-outdated-components"><span>06 Vulnerable and Outdated Components</span></a></h2><p>Software ist nie fehlerfrei</p><p>Fehler können aus verwendeten Bibliotheken / Frameworks stammen, oft weil diese nicht aktuell gehalten werden</p><h3 id="common-vulnerabilty-and-exposures-cve" tabindex="-1"><a class="header-anchor" href="#common-vulnerabilty-and-exposures-cve"><span>Common Vulnerabilty and Exposures (CVE)</span></a></h3><p>Einheitliche Namenskonvention für Schwachstellen, eindeutige Nummer inkl. Jahr</p><ul><li>ID</li><li Reserved,="" Disputed,="" Reject,="" active="">Status <mjx-container class="MathJax" jax="SVG" style="position:relative;"><svg style="vertical-align:-0.025ex;" xmlns="http://www.w3.org/2000/svg" width="2.262ex" height="1.181ex" role="img" focusable="false" viewBox="0 -511 1000 522" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">→</mo></math></mjx-assistive-mml></mjx-container></li><li>Kurzbeschreibung</li><li>Referenzen: Reports, Metasploit, ...</li><li>Kritikalität: CVSS Score (Base Score, Temporal Score, Environmental Score)</li></ul><h3 id="schutzmaßnahmen-gegen-vulnerable-and-outdated-components" tabindex="-1"><a class="header-anchor" href="#schutzmaßnahmen-gegen-vulnerable-and-outdated-components"><span>Schutzmaßnahmen gegen Vulnerable and Outdated Components</span></a></h3><ul><li>wenn möglich: keine fremden Komponenten</li><li>regelmäßige Upgrades</li><li>Langzeitsupport (LTS) verwenden</li><li>verwendete Komponenten erfassen &amp; überwachen</li><li>nicht benötigte Funktionalität mittels Wrapper deaktivieren</li><li>regelmäßige Security Tests</li></ul><h3 id="gateways" tabindex="-1"><a class="header-anchor" href="#gateways"><span>Gateways</span></a></h3><p>Stelle, an der Komponenten aufgenommen werden können: Abweisung, Entfernung und Verwaltung der Komponente muss möglich sein</p><ul><li><strong>Selection / Consumption</strong><ul><li>Untersuchung der Herkunft: Lizenzbedingungen, Security, Qualität</li><li>Check, dass richtige Komponente heruntergeladen</li><li>Policy, die eine Komponente erfüllen muss (Updates, Umgang mit Schwachstellen, Vertrauenswürdigkeit)</li></ul></li><li><strong>Integration</strong><ul><li>unveränderte Übernahme in das Projekt</li><li>über gesamte Entwicklung Konformität mit Policies prüfen</li></ul></li><li><strong>Deployment</strong><ul><li>im Endprodukt selbe Komponente wie in der Entwicklung</li><li>fehlerfreie Konfiguration</li><li>aktive Suche nach Verwundbarkeiten in den verwendeten Komponenten</li><li>regelmäßige Updates</li></ul></li></ul><h2 id="_07-identification-and-authorization-failures" tabindex="-1"><a class="header-anchor" href="#_07-identification-and-authorization-failures"><span>07 Identification and Authorization Failures</span></a></h2><p>Schwachstelle in Authentifikation oder Session Management gefährdet Accounts (insbesondere privilegierte) <mjx-container class="MathJax" jax="SVG" style="position:relative;"><svg style="vertical-align:-0.025ex;" xmlns="http://www.w3.org/2000/svg" width="2.262ex" height="1.181ex" role="img" focusable="false" viewBox="0 -511 1000 522" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">→</mo></math></mjx-assistive-mml></mjx-container> Passwörter und Session-IDs sind besonders gut zu schützen</p><h3 id="mogliche-schwachstellen-zu-authentifikation-und-session-management" tabindex="-1"><a class="header-anchor" href="#mogliche-schwachstellen-zu-authentifikation-und-session-management"><span>Mögliche Schwachstellen zu Authentifikation und Session Management</span></a></h3><ul><li>Session ID steht in URL <mjx-container class="MathJax" jax="SVG" style="position:relative;"><svg style="vertical-align:-0.025ex;" xmlns="http://www.w3.org/2000/svg" width="2.262ex" height="1.181ex" role="img" focusable="false" viewBox="0 -511 1000 522" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">→</mo></math></mjx-assistive-mml></mjx-container> kann versehentlich geteilt werden</li><li>Logout an öffentlichem Ort vergessen und Session Timeout zu hoch</li><li>Angreifer hat Zugang zur Passwort-Datenbank, welche nicht ausreichend geschützt ist</li></ul><h3 id="moglicher-angriff-session-fixation" tabindex="-1"><a class="header-anchor" href="#moglicher-angriff-session-fixation"><span>Möglicher Angriff: Session Fixation</span></a></h3><ol><li>Angreifer beschafft gültige Session ID</li><li>schiebt Session ID Opfer unter</li><li>Opfer authentifiziert sich</li><li>Angreifer hat authentifizierte Session</li></ol><p>Session ID an das Opfer durch</p><ul><li>Link der Session ID enthält</li><li>gefälschte Login-Seite (dann auch Passwort bekannt)</li><li>XSS und einen Cookie</li></ul><h3 id="allgemeine-richtlinien-zur-authentifizierung" tabindex="-1"><a class="header-anchor" href="#allgemeine-richtlinien-zur-authentifizierung"><span>Allgemeine Richtlinien zur Authentifizierung</span></a></h3><ul><li>starke Passwörter erzwingen</li><li>sicheres Passwort-Recovery anbieten (inkl. persönlicher Daten und &quot;geheimer&quot; Fragen, Benutzername nur server-seitig zu Session ID gespeichert, Verwendung zweiter Faktor)</li><li>Multifaktor Authetifizierung verwenden</li><li>Fehlermeldungen generisch halten (zusätzlich zufällige Verzögerung <mjx-container class="MathJax" jax="SVG" style="position:relative;"><svg style="vertical-align:-0.025ex;" xmlns="http://www.w3.org/2000/svg" width="2.262ex" height="1.181ex" role="img" focusable="false" viewBox="0 -511 1000 522" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">→</mo></math></mjx-assistive-mml></mjx-container> Verhinderung Informationsgewinn)</li><li>Passwörter nur in sicheren Kanälen übermitteln</li><li>bei mehreren erfolglosen Anmeldeversuchen temporär sperren</li></ul><h3 id="allgemeine-richtlinien-zum-session-management" tabindex="-1"><a class="header-anchor" href="#allgemeine-richtlinien-zum-session-management"><span>Allgemeine Richtlinien zum Session Management</span></a></h3><p>Zustandshaltung mit Zugriffsrechten &amp; Lokalisierung, Pre-Auth oder Post-Auth</p><ul><li>temporär gleichwertig mit verwendeten Credentials</li><li>muss vor <strong>Session Hijacking</strong> geschützt werden</li><li>nichtssagender Name z.B. &quot;id&quot;, damit kein Schluss auf verwendetes Framework</li><li>sollte mehr als 128 Bit lang sein und mehr als 64 Bit <strong>Entropie</strong> beinhalten</li><li>Bedeutung ist nur auf dem Server gespeichert</li><li>am besten Speicherung in Cookie <ul><li>lässt auch Verfallszeit und granulare Einschränkung definieren</li><li>ansonsten auch Body Argument, Hidden Field, Http Header, etc. denkbar</li></ul></li><li>am besten vorhandene Implementierung von <strong>Framework</strong> verwenden <ul><li>keine Default Konfiguration</li><li>aktuell halten</li></ul></li><li>HTTPS für gesamte Session verwenden</li><li>Cookie Attribute <ul><li><strong>Secure</strong>: Übertragung nur über sicheren Kanal</li><li><strong>HttpOnly</strong>: kein Zugriff per JavaScript</li><li><strong>Domain</strong>: Cookie darf nur an definerte Domain und deren Subdomains gesendet werden</li><li><strong>Path</strong>: Einschränkung von Verzeichnissen</li><li><strong>Expire</strong>: Ablaufzeit</li><li><strong>Max-Age</strong>: geht vor Expire</li></ul></li><li>Lbenszyklus <ul><li>Art der Erzeugung: <strong>permissive</strong> (zu Session ID von Benutzer wird Session erzeugt), heute meist <strong>strict</strong> (nur der Server kann eine Session ID erzeugen, sonst kommt ein Alarm)</li><li>muss wie nicht vertrauenswürdiges Datum behandelt werden</li><li>muss bei Rechteänderung neu erzeugt werden</li><li>Lebensdauer sollte so kurz wie möglich sein (kritisch: 2-5 Minuten, niedriges Risiko: 15-30 Minuten)</li></ul></li></ul><h2 id="_08-software-and-data-integrity-failures" tabindex="-1"><a class="header-anchor" href="#_08-software-and-data-integrity-failures"><span>08 Software and Data Integrity Failures</span></a></h2><ul><li><strong>Code</strong> und <strong>Infrastruktur</strong> schützen die Integrität nicht (Anwendungen, Bibliotheken)</li><li><strong>unsichere CI/CD Pipelines</strong> (kompromittierte Systeme, Malicious Code)</li><li>nicht vertrauenswürdige <strong>Updates</strong> (fehlende Signatur, dubiose Quelle)</li></ul><p><mjx-container class="MathJax" jax="SVG" style="position:relative;"><svg style="vertical-align:-0.025ex;" xmlns="http://www.w3.org/2000/svg" width="2.262ex" height="1.181ex" role="img" focusable="false" viewBox="0 -511 1000 522" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">→</mo></math></mjx-assistive-mml></mjx-container> Angreifer können eigenen Code ausführen lassen</p><h3 id="gegenmaßnahmen-zu-software-and-data-integrity-failures" tabindex="-1"><a class="header-anchor" href="#gegenmaßnahmen-zu-software-and-data-integrity-failures"><span>Gegenmaßnahmen zu Software and Data Integrity Failures</span></a></h3><ul><li>Verwendung von <strong>Signaturen</strong></li><li><strong>Vertrauenswürdigkeit</strong> eines Projektes <ul><li>Maturity Status</li><li>AutorInnen</li></ul></li><li>Bibliotheks- und Artefakte-Management (z.B. Nexuslib)</li><li><strong>Supply Chain</strong> Management (z.B. OWASP Dependency Check)</li><li>für <strong>Intrastructure as Code</strong><ul><li>IDE Plugins</li><li>Risikoanalyse</li><li>Verwaltung von <strong>Secrets</strong></li><li>Versionskontrolle (Transparenz)</li><li><strong>Least Privilege</strong> für Entwickler</li><li><strong>Statische Analyse</strong></li><li><strong>Artifact Signing</strong></li><li>Deployment <ul><li><strong>Inventory Management</strong>: Ressourcen labeln, tracken und loggen</li><li><strong>Dynamische Analyse</strong> der Interoperabilität: erkennt potenzielle Risiken</li></ul></li><li>zur Laufzeit <ul><li>bei Änderung <strong>gesamte</strong> Intrastruktur <strong>neu</strong> provisionieren</li><li>aktiviertes <strong>Logging</strong></li><li><strong>Security Monitoring</strong> (z.B. Prometheus, Grafana)</li><li>Bedrohungserkennung: unerwartetes Verhalten</li></ul></li></ul></li></ul><h2 id="_09-security-logging-and-monitoring-failures" tabindex="-1"><a class="header-anchor" href="#_09-security-logging-and-monitoring-failures"><span>09 Security Logging and Monitoring Failures</span></a></h2><p>Unzureichendes Logging:</p><ul><li><strong>kritische Events</strong> nicht gespeichert</li><li>Warnung / Fehler erzeugt fehlerhafte oder unzureichende Informationen</li><li>nicht überwachte oder nur lokal gespeicherte <strong>Logfiles</strong></li><li>keine <strong>Schwellenwerte</strong> oder keine Überwachung von Warnungen</li><li>durch Penetrationstests oder Dynamic Application Security Testing Tools werden keine <strong>Alerts</strong> erzeugt</li><li>Angriffsversuche werden nicht oder nicht in <strong>Echtzeit</strong> erkannt</li></ul><h3 id="vorteile-durch-logging" tabindex="-1"><a class="header-anchor" href="#vorteile-durch-logging"><span>Vorteile durch Logging</span></a></h3><ul><li>Erkennung von sicherheitsrelevanten Vorfällen (<strong>security incidents</strong>)</li><li>Erkennung von Verstößen gegen eine <strong>Policy</strong></li><li>unterstützt <strong>Nicht-Abstreitbarkeit</strong></li><li>kann <strong>Fehler</strong> erkennen</li><li>zusätzliche Informationen für Incident Response Prozess</li></ul><h3 id="sicheres-logging" tabindex="-1"><a class="header-anchor" href="#sicheres-logging"><span>Sicheres Logging</span></a></h3><ul><li>Anmelde- und Zugriffssteuerung sowie serverseitige Eingabeüberprüfung sollte mit ausreichendem <strong>Benutzerkontext</strong> protokolliert werden <mjx-container class="MathJax" jax="SVG" style="position:relative;"><svg style="vertical-align:-0.025ex;" xmlns="http://www.w3.org/2000/svg" width="2.262ex" height="1.181ex" role="img" focusable="false" viewBox="0 -511 1000 522" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">→</mo></math></mjx-assistive-mml></mjx-container> Aufbewahrung für verzögerte <strong>forensische Analyse</strong></li><li>Logfiles in universellem <strong>Format</strong> <mjx-container class="MathJax" jax="SVG" style="position:relative;"><svg style="vertical-align:-0.025ex;" xmlns="http://www.w3.org/2000/svg" width="2.262ex" height="1.181ex" role="img" focusable="false" viewBox="0 -511 1000 522" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">→</mo></math></mjx-assistive-mml></mjx-container> einfache Auswertung</li><li>korrekte <strong>Codierung</strong> (Vermeidung von Injection)</li><li><strong>Audit-Trail</strong> mit Integritätskontrollen (Verhinderung von Manipulation / Löschung)</li><li>effektive Überwachung mit Alarmierung, um schnell reagieren zu können</li><li>Events für das Logging: <ul><li>Änderung Zugriffsberechtigung oder Konfiguration</li><li>Lesen / Schreiben von sensiblen Daten</li><li>Löschen</li><li>Zugriffsaktionen mit Berechtigungen</li><li>Authentifizierungs-Ereignisse</li><li>Starten / Stoppen von Services</li></ul></li><li>Informationen des Logevents: <ul><li><strong>Wann</strong> (Zeitstempel)</li><li><strong>Wo</strong>: Anwendung, Service, Seite, Codestelle</li><li><strong>Wer</strong>: IP-Adresse, Benutzername</li><li><strong>Was</strong>: Art, Kritikalität, Sicherheitsrelevanz, Beschreibung, ggf. Ergebnisstatus</li></ul></li><li><ins>Nicht</ins> Teil des Logevents: <ul><li>Quellcode</li><li>Session-Identifier, Access Token, Passwörter, private Schlüssel</li><li>PII und sensible Daten</li><li>Datenbank oder Verbindungsdaten</li><li>Bank- oder Kreditkartendaten</li><li>Business-kritische Daten</li><li>Daten, die - bspw. per Gesetz - nicht gesammelt werden dürfen</li></ul></li><li>Schutz der Logging-Informationen <ul><li><strong>At Rest</strong>: Backup auf &quot;read-only&quot;-Speicher, Monitoring, eingeschränkter Zugriff</li><li><strong>In Transit</strong>: verschlüsselte Übertragung, Due Diligence Checks</li><li><strong>sofortige Kopie</strong> auf getrenntes System (z.B. via syslog-ng)</li><li>massives Erzeugen von Logereignissen darf Ressourcen des Systems nicht ausschöpfen</li><li>lokale Logfiles auf <strong>getrennter Partition</strong></li><li>Anschluss des Servers an <strong>zentrale Zeitsynchronisierung</strong> (NTP)</li></ul></li></ul><h2 id="_10-2013-unvalidated-redirects-and-forwards" tabindex="-1"><a class="header-anchor" href="#_10-2013-unvalidated-redirects-and-forwards"><span>10/2013 Unvalidated Redirects and Forwards</span></a></h2><p>Ungeprüfte Um- und Weiterleitung wird gerne für <strong>Phishing</strong>-Angriffe verwendet</p><p>Manchmal steht Zielseite in unvalidiertem Parameter <mjx-container class="MathJax" jax="SVG" style="position:relative;"><svg style="vertical-align:-0.025ex;" xmlns="http://www.w3.org/2000/svg" width="2.262ex" height="1.181ex" role="img" focusable="false" viewBox="0 -511 1000 522" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">→</mo></math></mjx-assistive-mml></mjx-container> kann möglicherweise für Umgehung der Autorisierung verwendet werden</p><h3 id="gegenmaßnahmen-zu-unvalidated-redirects-and-forwards" tabindex="-1"><a class="header-anchor" href="#gegenmaßnahmen-zu-unvalidated-redirects-and-forwards"><span>Gegenmaßnahmen zu Unvalidated Redirects and Forwards</span></a></h3><ul><li>keine Redirects und Forwards verwenden</li><li>falls doch notwendig <ul><li>URL mit Allowlist prüfen</li><li>nicht den Benutzerinput für die Ermittlung des Ziels verwenden</li></ul></li><li>immer auch am Ziel die Autorisierung prüfen</li><li>keine URL als Parameter, sondern Wert, der serverseitig in URL übersetzt wird</li></ul><h2 id="prinzipien-sicherer-webanwendungen" tabindex="-1"><a class="header-anchor" href="#prinzipien-sicherer-webanwendungen"><span>Prinzipien sicherer Webanwendungen</span></a></h2><h3 id="_1-kenne-das-sicherheitsmodell-des-verwendeten-frameworks" tabindex="-1"><a class="header-anchor" href="#_1-kenne-das-sicherheitsmodell-des-verwendeten-frameworks"><span>1. Kenne das Sicherheitsmodell des verwendeten Frameworks</span></a></h3><p>&quot;Kenne deinen Werkzeugkasten&quot;</p><ul><li><strong>Session Management</strong>, Datenbankzugriff, etc.</li><li>Unterstützung durch <strong>Browser-Features</strong><ul><li><strong>Sandboxing</strong>: Separation des Codes und Zugriffsregeln <mjx-container class="MathJax" jax="SVG" style="position:relative;"><svg style="vertical-align:-0.025ex;" xmlns="http://www.w3.org/2000/svg" width="2.262ex" height="1.181ex" role="img" focusable="false" viewBox="0 -511 1000 522" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">→</mo></math></mjx-assistive-mml></mjx-container> Schutz des Clients vor schädlichem Code</li><li><strong>Same-Origin Policy</strong>: Begrenzung auf einen einzigen Kontext (Protokoll, Host &amp; Port)</li></ul></li><li>oft nicht bekannt oder falsch eingesetzt</li></ul><h3 id="_2-vertraue-nicht-dem-client" tabindex="-1"><a class="header-anchor" href="#_2-vertraue-nicht-dem-client"><span>2. Vertraue nicht dem Client</span></a></h3><p>&quot;You handshake with your client, but you never trust it&quot;</p><p>Wenn ein Angreifer den Client kontrolliert</p><ul><li>veränderte <strong>Verarbeitungsreihenfolge</strong> <mjx-container class="MathJax" jax="SVG" style="position:relative;"><svg style="vertical-align:-0.025ex;" xmlns="http://www.w3.org/2000/svg" width="2.262ex" height="1.181ex" role="img" focusable="false" viewBox="0 -511 1000 522" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">→</mo></math></mjx-assistive-mml></mjx-container> z.B. <strong>XSS</strong></li><li>veränderte Daten: z.B. Ablaufdatum in Cookie, Hidden Field, ...</li><li>erneutes Einspielen alter Daten: bspw. wenn Zustandshaltung in Cookie</li><li>veränderte <strong>Metadaten</strong>: bspw. Zugriff ohne Login für GoogleBot UserAgent <mjx-container class="MathJax" jax="SVG" style="position:relative;"><svg style="vertical-align:-0.025ex;" xmlns="http://www.w3.org/2000/svg" width="2.262ex" height="1.181ex" role="img" focusable="false" viewBox="0 -511 1000 522" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">→</mo></math></mjx-assistive-mml></mjx-container> Änderung des UserAgent im Request</li><li>client-seitige Ausführung von Code: Veränderung im lokalen JavaScript</li></ul><p>Daher</p><ul><li>wichtige Entscheidungen nur auf dem Server treffen: Authentifizierung, Autorisierung, kritische Entscheidungen</li><li>Daten an den Client als öffentlich betrachten</li><li><strong>Input-Validierung</strong> auf dem Server</li><li><strong>Paranoides Vertrauensmodell</strong>: &quot;Vertraue nur dem, was du selbst beobachtest&quot;</li></ul><h3 id="_3-vermeide-die-nutzung-gefahrlicher-methoden" tabindex="-1"><a class="header-anchor" href="#_3-vermeide-die-nutzung-gefahrlicher-methoden"><span>3. Vermeide die Nutzung gefährlicher Methoden</span></a></h3><p>&quot;eval() ist evil&quot; (kompiliert String und führt diesen aus)</p><p>auch problematisch: setTimeout(), setInterval() und Function Constructor</p><h3 id="_4-verwende-sichere-kommunikation" tabindex="-1"><a class="header-anchor" href="#_4-verwende-sichere-kommunikation"><span>4. Verwende sichere Kommunikation</span></a></h3><p>Wo möglich <strong>SSL / TLS</strong> (inkl. gültiges Zertifikat)</p><h3 id="_5-harte-den-web-server" tabindex="-1"><a class="header-anchor" href="#_5-harte-den-web-server"><span>5. Härte den Web-Server</span></a></h3><p>Erhöhung der Sicherheit durch <strong>Reduzierung der Angriffsfläche</strong> (Konfiguration oder Erweiterung)</p><ul><li>Deaktivierung nicht benötigter Dienste</li><li>Einsatz gehärteter Betriebssysteme</li><li>Einspielen von <strong>Patches</strong></li></ul><p>Bei Linux</p><ul><li>Dienste bekommen <strong>Service Account</strong> ohne Login Shell (/bin/false) und mit minimalen Rechten</li><li>Verzeichnis-Rechte maximal beschränken, durch <strong>umask</strong> vorgeben</li><li>Passwortrichtlinie, Tarpitting um Bruteforce zu verlangsamen</li><li>ssh Konfiguration anpassen: Port, kein root Login, ...</li><li>Speicherverbrauch und Rechenzeit limitieren (ulimit)</li><li>Prioritäten setzen (nice)</li></ul><p>Bei Apache</p><ul><li>Versionsnummern aus Fingerprint entfernen</li><li>unsichere Request-Methoden deaktivieren</li><li>Zugriff auf Infos über Server-Status/Infos einschränken</li><li>Anzahl Zugriffe beschränken</li><li>SSL konfigurieren</li></ul><p>Bei PHP</p><ul><li>Fingerprinting verhindern</li><li>Anzeige von Fehlermeldungen deaktivieren</li><li>Verzeichniszugriff beschränken</li><li>temporäres Verzeichnis für Uploads</li><li>Deaktivierung bestimmter Funktionen / Klassen</li></ul><h3 id="_6-beschranke-die-komplexitat-auf-das-notwendige" tabindex="-1"><a class="header-anchor" href="#_6-beschranke-die-komplexitat-auf-das-notwendige"><span>6. Beschränke die Komplexität auf das Notwendige</span></a></h3><p>&quot;Keep it simple, stupid&quot; (<strong>KISS</strong>)</p><ul><li>verbesserte Wartbarkeit</li><li>Übersichtlichkeit</li></ul><h3 id="_7-verwende-security-patterns-wo-moglich" tabindex="-1"><a class="header-anchor" href="#_7-verwende-security-patterns-wo-moglich"><span>7. Verwende Security Patterns wo möglich</span></a></h3><ul><li><strong>Role-based Access Control</strong></li><li><strong>Client Input Filters</strong>, <strong>Intercepting Validator</strong></li><li><strong>Authentication / Authorization Enforcer</strong></li><li><strong>Secure Base Action</strong><ul><li>Sicherheitsaktionen gebündelt in einem Modul</li></ul></li><li><strong>Secure Logger</strong>, <strong>Secure Storage</strong></li><li><strong>Secure Session Manager</strong></li><li><strong>Web Agent Interceptor</strong><ul><li>Proxy vor Webserver, welcher Security Policies erzwingt</li></ul></li><li>...</li></ul><h3 id="_8-defense-in-depth" tabindex="-1"><a class="header-anchor" href="#_8-defense-in-depth"><span>8. Defense in Depth</span></a></h3><p>&quot;Man kann nie genug Sicherheitsmaßnahmen in Stellung haben&quot;</p><ul><li>nicht nur auf eine Schutzmaßnahme verlassen, sozusagen Redundanz</li><li>verschieden Produkte und Hersteller</li><li>&quot;wie eine Artischocke&quot; aufbauen</li></ul><h3 id="_9-check-at-the-gate" tabindex="-1"><a class="header-anchor" href="#_9-check-at-the-gate"><span>9. Check at the Gate</span></a></h3><p>&quot;Lass keinen Angreifer in dein Haus&quot;</p><p><strong>Perimeterschutz</strong>: eingehenden Verkehr so früh wie möglich prüfen</p><h3 id="_10-fail-securely" tabindex="-1"><a class="header-anchor" href="#_10-fail-securely"><span>10. Fail securely</span></a></h3><p>Durch eine gebrochene Sicherheitsmaßnahme sollte nur minimaler Schaden entstehen können</p><h3 id="_11-secure-defaults" tabindex="-1"><a class="header-anchor" href="#_11-secure-defaults"><span>11. Secure Defaults</span></a></h3><p>&quot;Stelle Sicherheit von Anfang an sicher&quot; <mjx-container class="MathJax" jax="SVG" style="position:relative;"><svg style="vertical-align:-0.025ex;" xmlns="http://www.w3.org/2000/svg" width="2.262ex" height="1.181ex" role="img" focusable="false" viewBox="0 -511 1000 522" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">→</mo></math></mjx-assistive-mml></mjx-container> sichere Grundeinstellungen</p><ul><li>maximal geschützte Accounts</li><li>i.d.R. schlechtere Usability</li></ul><h2 id="testen-von-webanwendungen" tabindex="-1"><a class="header-anchor" href="#testen-von-webanwendungen"><span>Testen von Webanwendungen</span></a></h2><p><strong>OWASP Testing Project</strong>: Testing-Framework für eigene Tests</p><p>Prinzipien für das Testen:</p><ul><li>möglichst weitreichend denken</li><li>am besten im Rahmen eines SDLC</li><li>früh beginnen</li><li>Verständnis entwickeln</li><li>die richtigen Werkzeuge verwenden <ul><li><strong>manuelle Reviews</strong>: überprüft Auswirkungen auf die Sicherheit (Analyse der Dokumentation, Interviews mit Architekten / System Owner) <ul><li>flexibel einsetzbar, aber aufwändig in der Durchführung</li><li>erfordert guten Umgang mit Menschen</li></ul></li><li><strong>Bedrohungs- und Risikoanalyse</strong>: Bedrohungen frühzeitig erkennen können</li><li><strong>Code Review</strong>: manuelle Überprüfung des Quellcodes <ul><li>viele Verwundbarkeiten können gar nicht gefunden werden (Bibliotheken, Laufzeitfehler, etc.)</li><li>häufige Fehler, offensichtliche Schwachstellen, Schadcode, etc. kann eliminiert werden</li></ul></li><li><strong>Penetration Testing</strong><ul><li>schnelle Durchführung, aber prüft nur &quot;erste Verteidigungslinie&quot; (falls diese hält)</li></ul></li></ul></li><li>auf Details achten</li><li>Metriken entwickeln</li><li>Ergebnisse dokumentieren</li></ul><h3 id="penetration-testing" tabindex="-1"><a class="header-anchor" href="#penetration-testing"><span>Penetration Testing</span></a></h3><p><strong>Black Box Test</strong> aus <strong>Sicht eines Angreifers</strong> (teilweise mit automatisierten Tools)</p><h4 id="sammeln-von-informationen" tabindex="-1"><a class="header-anchor" href="#sammeln-von-informationen"><span>Sammeln von Informationen</span></a></h4><p>Anfangs <strong>passive</strong> Tests (Google, wget, etc.)</p><ul><li>Ressourcen entdecken und festhalten <ul><li>Webseite netcraft</li></ul></li><li>Versionsnummern herausfinden (<strong>Fingerprinting</strong>): httprint</li><li>verfügbare Anwendungen analysieren <ul><li>manche Webserver haben typische Header-Reihenfolge</li><li><strong>Portscanner</strong>: nmap</li></ul></li><li>ggf. Fehlermeldungen analysieren</li></ul><h4 id="uberprufungen" tabindex="-1"><a class="header-anchor" href="#uberprufungen"><span>Überprüfungen</span></a></h4><p>Configuration Management (&quot;schwache Konfiguration&quot;)</p><ul><li>schwache Verschlüsselung</li><li>Behandlung von File Extensions</li><li>alte Dateien <mjx-container class="MathJax" jax="SVG" style="position:relative;"><svg style="vertical-align:-0.025ex;" xmlns="http://www.w3.org/2000/svg" width="2.262ex" height="1.181ex" role="img" focusable="false" viewBox="0 -511 1000 522" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">→</mo></math></mjx-assistive-mml></mjx-container> Hinweise auf Aufbau der Anwendung</li><li>Admin Interfaces</li><li>zu umfangreiche Fehlermeldungen</li><li>Directory Traversal</li></ul><p>Authentifikation</p><ul><li>unsichere Übermittlung von Credentials</li><li>User Enumeration</li><li>Brute Force</li><li>mögliche Umgehungen</li><li>Nebenläufigkeitsprobleme (Race Conditions)</li></ul><p>Session Management</p><ul><li>Session Hijacking</li><li>Session Fixation</li><li>CSRF</li><li>Cookies falls verwendet <ul><li>fehlendes Secure Attribut</li><li>ungeschützte Übermittlung</li><li>Ablaufzeiten</li><li>Cache Einstellungen</li></ul></li></ul><p>Autorisierung</p><ul><li>Rechtezuweisung</li><li>Directory Traversal</li><li>Privilege Escalation</li><li>mögliche Umgehungen</li></ul><p>Business Logic</p><ul><li>mögliche Brechung der Anwendung durch ungewähnliche Reihenfolge von Aktionen</li></ul><p>Daten-Validierung</p><ul><li>Input Validation</li><li>XSS</li><li>Injections</li></ul><p>Denial of Service</p><ul><li>SQL Wildcard Attack <mjx-container class="MathJax" jax="SVG" style="position:relative;"><svg style="vertical-align:-0.025ex;" xmlns="http://www.w3.org/2000/svg" width="2.262ex" height="1.181ex" role="img" focusable="false" viewBox="0 -511 1000 522" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">→</mo></math></mjx-assistive-mml></mjx-container> sehr aufwändige Suche durch komplizierten Vergleich</li><li>Buffer Overflows</li></ul><p>AJAX Testing</p><h3 id="owasp-testing-framework" tabindex="-1"><a class="header-anchor" href="#owasp-testing-framework"><span>OWASP Testing Framework</span></a></h3><ul><li>Phase 1: <strong>vor</strong> der Entwicklung <ul><li>Dokumentation der Security Policies</li><li>Reviews bestehender Regeln</li><li>Sicherheitsbedarf feststellen</li><li>Metriken und Mess-Zeitpunkte festlegen</li></ul></li><li>Phase 2: während des <strong>Designs</strong><ul><li>Annahmen prüfen</li><li>Überprüfung der sicherheitsrelevanten Mechanismen</li><li>Überprüfung der Architektur (und dass diese ausreichend dokumentiert ist)</li><li>Bedrohungs- und Risikoanalyse</li></ul></li><li>Phase 3: während der <strong>Implementierung</strong><ul><li>Code Review</li><li>Code Walkthroughs</li><li>am Ende: Penetration Testing</li></ul></li><li>Phase 4: während des <strong>Deployments</strong><ul><li>&quot;Last Minute Penetration Testing&quot;: erfahrungsgemäß notwendig</li><li>überprüft auch korrekte Konfiguration</li></ul></li><li>Phase 5: während des <strong>Betriebs</strong><ul><li>Anwendung aktuell halten (Application Patching)</li><li>Policies regelmäßig prüfen</li><li>Penetration Testing nach vorgegebenem Zeitplan (Health Check)</li><li>Quality Assurance für ALLE Änderungen</li></ul></li></ul></div><!----><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a class="auto-link external-link vp-meta-label" href="https://github.com/ChabbaY/ChabbaYsZusammenfassungen-Blog/edit/main/docs/posts/WiSe2425/SicherheitVonWebanwendungen.md" aria-label="Edit this page on GitHub" rel="noopener noreferrer" target="_blank"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon" name="edit"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->Edit this page on GitHub<!----></a></div><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">Last update: </span><span class="vp-meta-info" data-allow-mismatch="text">1/28/2025, 4:14:17 PM</span></div><div class="contributors"><span class="vp-meta-label">Contributors: </span><!--[--><!--[--><span class="vp-meta-info" title="email: linus@englert.cloud">Linus Englert</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a class="route-link auto-link prev" href="/ChabbaYsZusammenfassungen-Blog/posts/WiSe2425/ComputergrafikUndBildverarbeitung.html" aria-label="Computergarfik und Bildverarbeitung"><div class="hint"><span class="arrow start"></span>Prev</div><div class="link"><!---->Computergarfik und Bildverarbeitung</div></a><!----></nav><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper" vp-footer><div class="vp-footer">Keine Gewährleistung für fehlerfreie Inhalte</div><div class="vp-copyright">Copyright © 2025 Linus Englert </div></footer></div><!--]--><!--[--><!----><!--[--><!--]--><!--]--><!--]--></div>
    <script type="module" src="/ChabbaYsZusammenfassungen-Blog/assets/app-CEbH5TK9.js" defer></script>
  </body>
</html>
